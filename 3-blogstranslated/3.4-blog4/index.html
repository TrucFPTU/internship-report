<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 3 :: Internship Report</title>
<link href=../../css/nucleus.css?1765374077 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1765374077 rel=stylesheet><link href=../../css/hybrid.css?1765374077 rel=stylesheet><link href=../../css/featherlight.min.css?1765374077 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1765374077 rel=stylesheet><link href=../../css/auto-complete.css?1765374077 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1765374077 rel=stylesheet><link href=../../css/theme.css?1765374077 rel=stylesheet><link href=../../css/hugo-theme.css?1765374077 rel=stylesheet><link href=../../css/theme-workshop.css?1765374077 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1765374077></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.4-blog4/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1765374077></script><script type=text/javascript src=../../js/auto-complete.js?1765374077></script><script type=text/javascript>var baseurl="https://trucfptu.github.io/internshiop-report/"</script><script type=text/javascript src=../../js/search.js?1765374077></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=../../1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Week 9 Worklog" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Week 9 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Week 10 Worklog" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Week 10 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Week 11 Worklog" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Week 11 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.12-week12/ title="Week 12 Worklog" class=dd-item><a href=../../1-worklog/1.12-week12/><b>1.12. </b>Week 12 Worklog
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 2" class=dd-item><a href=../../3-blogstranslated/3.3-blog3/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.4-blog4/ title="Blog 3" class="dd-item
active"><a href=../../3-blogstranslated/3.4-blog4/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=../../4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.5-event5/ title=Event5 class=dd-item><a href=../../4-eventparticipated/4.5-event5/><b>4.2. </b>Event5
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/ title=Workshop class=dd-item><a href=../../5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/ title=Introduction class=dd-item><a href=../../5-workshop/5.1-workshop-overview/><b>5.1. </b>Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/ title=Prerequiste class=dd-item><a href=../../5-workshop/5.2-prerequiste/><b>5.2. </b>Prerequiste
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-create-environmnet/ title="Create environment" class=dd-item><a href=../../5-workshop/5.3-create-environmnet/><b>5.3 </b>Create environment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4upload-and-deploy/ title="Upload and deploy" class=dd-item><a href=../../5-workshop/5.4upload-and-deploy/><b>5.4. </b>Upload and deploy
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-policy/ title="Access the application and test" class=dd-item><a href=../../5-workshop/5.5-policy/><b>5.5. </b>Access the application and test
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.6-cleanup/ title="Monitoring and Clean up" class=dd-item><a href=../../5-workshop/5.6-cleanup/><b>5.6. </b>Monitoring and Clean up
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing and Feedback" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing and Feedback
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://trucfptu.github.io/internshiop-report/3-blogstranslated/3.4-blog4/ selected>English</option><option id=vi value=https://trucfptu.github.io/internshiop-report/vi/3-blogstranslated/3.4-blog4/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 3</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#read-performance-comparison>Read performance comparison</a><ul><li><a href=#phase-1-baseline-performance>Phase 1: Baseline performance</a></li><li><a href=#phase-2-emrfs-analysis>Phase 2: EMRFS analysis</a></li><li><a href=#phase-3-open-source-s3a-testing>Phase 3: Open source S3A testing</a></li><li><a href=#test-execution-and-results>Test execution and results</a></li></ul></li><li><a href=#read-cost-comparison>Read cost comparison</a></li><li><a href=#write-performance-comparison>Write performance comparison</a><ul><li><a href=#static-tablepartition-overwrite>Static table/partition overwrite</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 3</h1><h1 id=optimizing-amazon-emr-runtime-for-apache-spark-with-emr-s3a>Optimizing Amazon EMR runtime for Apache Spark with EMR S3A</h1><p><em>By Giovanni Matteo Fumarola, Narayanan Venkateswaran, Syed Shameerur Rahman, Sushil Kumar Shivashankar, and Rajarshi Sarkar – September 24, 2025 – in Amazon EMR, Analytics, Best Practices, Intermediate (200), Permalink</em></p><p>With the Amazon EMR 7.10 runtime, Amazon EMR introduced EMR S3A, an enhanced implementation of the open source S3A file system connector. This enhanced connector is now automatically configured as the default S3 file system connector for Amazon EMR deployment options, including Amazon EMR on EC2, Amazon EMR Serverless, Amazon EMR on Amazon EKS, and Amazon EMR on AWS Outposts, while maintaining full compatibility with the open source Apache Spark APIs.</p><p>In the Amazon EMR 7.10 runtime for Apache Spark, the EMR S3A connector delivers read performance comparable to EMRFS, as demonstrated by TPC-DS query benchmarks. The most significant performance improvements appear in write operations, with a 7% improvement for static partition overwrites and a 215% improvement for dynamic partition overwrites compared to EMRFS. In this post, we present the improved read and write performance benefits when using the Amazon EMR 7.10.0 runtime for Apache Spark with EMR S3A, compared to EMRFS and the open source S3A file system connector.</p><h2 id=read-performance-comparison>Read performance comparison</h2><p>To evaluate read performance, we used a test environment based on Amazon EMR runtime version 7.10.0 running Spark 3.5.5 and Hadoop 3.4.1. The test infrastructure consists of an Amazon Elastic Compute Cloud (Amazon EC2) cluster with nine <code>r5d.4xlarge</code> instances. The primary node has 16 vCPUs and 128 GB of memory, and the eight core nodes provide a total of 128 vCPUs and 1024 GB of memory.</p><p>The performance evaluation was conducted using a comprehensive benchmarking approach to ensure accurate and meaningful results. The input dataset uses a scale factor of 3 TB, with 17.7 billion records, approximately 924 GB of compressed data, partitioned in Parquet format. Setup instructions and technical details are available in a GitHub repository. We used Spark’s in-memory data catalog to store metadata for the TPC-DS databases and tables.</p><p>To create a fair and accurate comparison between EMR S3A, EMRFS, and open source S3A implementations, we used a three-phase testing approach:</p><h3 id=phase-1-baseline-performance>Phase 1: Baseline performance</h3><ul><li>Establish baseline performance using the default Amazon EMR configuration with the EMR S3A connector</li><li>Create a reference point for subsequent comparisons</li></ul><h3 id=phase-2-emrfs-analysis>Phase 2: EMRFS analysis</h3><ul><li>Keep the default file system as EMRFS</li><li>Keep all other configurations unchanged</li></ul><h3 id=phase-3-open-source-s3a-testing>Phase 3: Open source S3A testing</h3><ul><li>Replace the <code>hadoop-aws.jar</code> file with the open source Hadoop S3A 3.4.1 implementation</li><li>Keep all other component configurations identical</li></ul><p>This controlled testing environment is crucial for the following reasons:</p><ul><li>Isolates the specific performance impact of the S3A connector implementation</li><li>Eliminates hidden variables that could skew results</li><li>Provides accurate measurements of performance improvements between the Amazon S3A implementation and the open source alternative</li></ul><h3 id=test-execution-and-results>Test execution and results</h3><p>Throughout the tests, we kept the test conditions and configurations consistent so that any observed performance differences could be attributed directly to variations in the S3A connector implementation.</p><p>We executed a total of 104 SparkSQL queries, each run 10 times. The average runtime over the 10 iterations for each query was used for comparison. The average runtime over 10 iterations on Amazon EMR 7.10 runtime for Apache Spark with EMR S3A was <strong>1116.87 seconds</strong>, which is <strong>1.08x faster than open source S3A</strong> and comparable to EMRFS. The figure (not shown here) illustrates the total runtime in seconds.</p><p>The following table summarizes the metrics:</p><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>OSS S3A</th><th style=text-align:left>EMRFS</th><th style=text-align:left>EMR S3A</th></tr></thead><tbody><tr><td style=text-align:left>Average runtime (seconds)</td><td style=text-align:left>1208.26</td><td style=text-align:left>1129.64</td><td style=text-align:left>1116.87</td></tr><tr><td style=text-align:left>Geometric mean of queries (seconds)</td><td style=text-align:left>7.63</td><td style=text-align:left>7.09</td><td style=text-align:left>6.99</td></tr><tr><td style=text-align:left>Total cost *</td><td style=text-align:left>$6.53</td><td style=text-align:left>$6.40</td><td style=text-align:left>$6.15</td></tr></tbody></table><p>* Detailed cost estimates are discussed later in this post.</p><p>A chart (not shown) illustrates query-level performance improvements of EMR S3A compared to open source S3A on Amazon EMR 7.10 runtime for Apache Spark. The speedup varies by query, with the fastest achieving a <strong>1.51x</strong> speedup for query <code>q3</code>, where Amazon EMR S3A outperforms open source S3A. The x-axis orders the 3 TB TPC-DS benchmark queries by decreasing performance gain observed with Amazon EMR, and the y-axis shows the magnitude of the speedup as a ratio.</p><h2 id=read-cost-comparison>Read cost comparison</h2><p>Our benchmark outputs total runtime and geometric mean metrics to measure Spark runtime performance. A cost metric provides additional insight. Cost estimates are computed using the following formulas. They include Amazon EC2, Amazon Elastic Block Store (Amazon EBS), and Amazon EMR costs, but exclude Amazon Simple Storage Service (Amazon S3) GET and PUT costs.</p><ul><li><p><strong>Amazon EC2 cost (including SSD cost)</strong><br><code>EC2 cost = number of instances * r5d.4xlarge hourly rate * job runtime (hours)</code></p><ul><li><code>r5d.4xlarge</code> hourly rate = <strong>$1.152 per hour</strong></li></ul></li><li><p><strong>Root Amazon EBS cost</strong><br><code>Root EBS cost = number of instances * EBS per GB-hour rate * root EBS size * job runtime (hours)</code></p></li><li><p><strong>Amazon EMR cost</strong><br><code>EMR cost = number of instances * r5d.4xlarge EMR cost * job runtime (hours)</code></p><ul><li><code>r5d.4xlarge</code> Amazon EMR cost = <strong>$0.27 per hour</strong></li></ul></li><li><p><strong>Total cost</strong><br><code>Total cost = EC2 cost + root EBS cost + EMR cost</code></p></li></ul><p>The following table summarizes the cost comparison:</p><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>EMRFS</th><th style=text-align:left>EMR S3A</th><th style=text-align:left>OSS S3A</th></tr></thead><tbody><tr><td style=text-align:left>Runtime (hours)</td><td style=text-align:left>0.50</td><td style=text-align:left>0.48</td><td style=text-align:left>0.51</td></tr><tr><td style=text-align:left>Number of EC2 instances</td><td style=text-align:left>9</td><td style=text-align:left>9</td><td style=text-align:left>9</td></tr><tr><td style=text-align:left>Root Amazon EBS size</td><td style=text-align:left>0 GB</td><td style=text-align:left>0 GB</td><td style=text-align:left>0 GB</td></tr><tr><td style=text-align:left>Amazon EC2 cost</td><td style=text-align:left>$5.18</td><td style=text-align:left>$4.98</td><td style=text-align:left>$5.29</td></tr><tr><td style=text-align:left>Amazon EBS cost</td><td style=text-align:left>$0.00</td><td style=text-align:left>$0.00</td><td style=text-align:left>$0.00</td></tr><tr><td style=text-align:left>Amazon EMR cost</td><td style=text-align:left>$1.22</td><td style=text-align:left>$1.17</td><td style=text-align:left>$1.24</td></tr><tr><td style=text-align:left><strong>Total cost</strong></td><td style=text-align:left>$6.40</td><td style=text-align:left>$6.15</td><td style=text-align:left>$6.53</td></tr><tr><td style=text-align:left>Cost savings vs. baseline</td><td style=text-align:left>Base</td><td style=text-align:left>EMR S3A is 1.04x faster than EMRFS</td><td style=text-align:left>EMR S3A is 1.06x faster than OSS S3A</td></tr></tbody></table><h2 id=write-performance-comparison>Write performance comparison</h2><p>We also benchmarked write performance for the Amazon EMR 7.10 runtime for Apache Spark.</p><h3 id=static-tablepartition-overwrite>Static table/partition overwrite</h3><p>We evaluate static table/partition overwrite write performance across different file systems using the following Spark SQL <code>INSERT OVERWRITE</code> query. The <code>SELECT * FROM range(...)</code> clause generates data at runtime. This produces approximately 15 GB of data across exactly 100 Parquet files in Amazon S3.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SET</span> <span style=color:#66d9ef>rows</span><span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>e9; <span style=color:#75715e>-- 4 Billion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SET</span> partitions<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> OVERWRITE DIRECTORY <span style=color:#e6db74>&#39;s3://${bucket}/perf-test/${trial_id}&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>USING</span> PARQUET
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> range(<span style=color:#ae81ff>0</span>, <span style=color:#960050;background-color:#1e0010>${</span><span style=color:#66d9ef>rows</span><span style=color:#960050;background-color:#1e0010>}</span>, <span style=color:#ae81ff>1</span>, <span style=color:#960050;background-color:#1e0010>${</span>partitions<span style=color:#960050;background-color:#1e0010>}</span>);
</span></span></code></pre></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/3.3-blog3/ title="Blog 2"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../4-eventparticipated/ title="Events Participated" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1765374077></script><script src=../../js/perfect-scrollbar.min.js?1765374077></script><script src=../../js/perfect-scrollbar.jquery.min.js?1765374077></script><script src=../../js/jquery.sticky.js?1765374077></script><script src=../../js/featherlight.min.js?1765374077></script><script src=../../js/highlight.pack.js?1765374077></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1765374077></script><script src=../../js/learn.js?1765374077></script><script src=../../js/hugo-learn.js?1765374077></script><link href=../../mermaid/mermaid.css?1765374077 rel=stylesheet><script src=../../mermaid/mermaid.js?1765374077></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>